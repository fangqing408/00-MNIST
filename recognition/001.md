# 数据准备

## 1 >> 数据格式

原本的数据在 'data/MNIST/raw' 里面，包含三个文件，其中 'train' 开头的两个压缩文件为训练集，'t10k' 开头的两个文件为测试集。

作者将文件进行了处理，采用最朴素最直观的方式分别放到 train 和 test 文件夹下面，子目录名称对应的就是里面图片的标签，因为直接采用图片的形式保存，可以直接打开图片查看，采用下面的形式存储。

```
train/
  ├── 0/
  │   ├── 0.jpg
  │   ├── 1.jpg
  │   └── ...
  ├── 1/
  │   ├── 7.jpg
  │   ├── 10.jpg
  │   └── ...
  └── ...
```

## 2 >> 数据处理

数据的处理的文件为 'load_images.py'，其实现了图片的前期处理，主要的内容为

```
def load_data(data_dir, classes, image_size, samples):
    paths = []
    images = []
    labels = []
    image_size = (image_size, image_size)
    for i in range(classes):
        path = os.path.join(data_dir, str(i))
        imglist = os.listdir(path) # 得到子目录下面的所有文件，同一个标签
        for sample in range(samples // classes):
            img = Image.open(os.path.join(path, imglist[sample])).convert('L')
            img = img.resize(image_size) # 修改图片的大小
            img_array = np.array(img, dtype='float32') / 255.0 # 归一化
            paths.append(os.path.join(path, imglist[sample])) # 添加图片路径
            images.append(img_array) # 添加图片
            labels.append(int(i)) # 添加标签
    return np.array(paths), np.array(images), np.array(labels)
```
