# 反向传播

## 1 >> 构建 one_hot 向量

one_hot 的向量的定义为，标签的位置为 1，其余位置为 0，也可以把他理解为，真实值向量，矩阵的大小和维度一定要心里有数，否则进行矩阵乘法运算的时候，没办法对应好。

```
def backward(image, activated1, pooled1, pool_indices1, activated2, pooled2, pool_indices2, flattened, predictions,
             label, conv_kernel1, conv_kernel2, fc_weights, fc_bias):
    one_hot = np.zeros((10,))
    one_hot[label] = 1
    y_true = one_hot
    d_fc_output = predictions - y_true
    ...
```

## 2 >> 全连接层前向传播

格局前向传播的公式，第 n 个神经元的第 m 个参数的梯度为：

$\frac{\partial J}{\partial w_{nm}}=\frac{1}{N}\sum_{i=1}^N(\hat y_n^{(i)}-y_n^{(i)})x_m^{(i)}\\ \frac{\partial J}{\partial b_n}=\frac{1}{N}\sum_{i=1}^N(\hat y_n^{(i)}-y_n^{(i)})\\$

## 2 >> 构建步骤

- 005 >> [模型训练](https://github.com/fangqing408/00-MNIST/blob/master/recognition/005.md)
- 006 >> [模型保存和预测](https://github.com/fangqing408/00-MNIST/blob/master/recognition/006.md)
